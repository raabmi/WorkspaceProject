<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Angelika Moder, Michaela Raab, Nicole Halmdienst, Sebastian Schrey, Wolfgang Rannetbauer" />


<title>Example_with_EUCAST_Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Example_with_EUCAST_Data</h1>
<h4 class="author">Angelika Moder, Michaela Raab, Nicole Halmdienst, Sebastian Schrey, Wolfgang Rannetbauer</h4>



<p>This documents is an introduction to the package <code>emGauss</code>. The aim of this package is to find the cutoff point (ECOFF) between resistant and non-resistant antibiotics.</p>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Therefore, first load the package <code>emGauss</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(emGauss)</code></pre></div>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>This package also includes real data (Zonedata) from the EUCAST website. This will be loaded in the next lines of code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">'ZD'</span>)</code></pre></div>
</div>
<div id="example-dataset" class="section level1">
<h1>Example Dataset</h1>
<p>In order to get an example dataset, we have to extract the nessercary columns from the ZD dataset. The plot shows that the data may have two components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 65, 855, 1091 example datasets </span>

zd &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(ZD[<span class="dv">1091</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">48</span>])
zd.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">bin =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">nrObs =</span> zd)
<span class="kw">barplot</span>(zd.data<span class="op">$</span>nrObs, <span class="dt">names.arg =</span> <span class="kw">c</span>(zd.data<span class="op">$</span>bin))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="find-optimum-number-of-components" class="section level1">
<h1>Find optimum number of components</h1>
<p>In this section we use the function <code>em.gauss.opti.groups</code> to find the optimum number of components based on the BIC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span><span class="dv">5</span>
y &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(zd)

result &lt;-<span class="kw">em.gauss.opti.groups</span>(<span class="dt">y =</span> y,
                     <span class="dt">k =</span> k,
                     <span class="dt">alpha =</span> <span class="dv">3</span>,
                     <span class="dt">beta=</span> <span class="dv">1</span>,
                     <span class="dt">method =</span> <span class="st">&quot;quantile&quot;</span>,
                     <span class="dt">epsilon=</span><span class="fl">0.0001</span>)</code></pre></div>
<p>As a result we get a list with all parameters of the fitted distribution and the AIC and BIC values. The next line of code shows the best number of components based on the BIC. As we can see is the optimum number of components 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(result<span class="op">$</span>BIC, <span class="dt">ylab =</span> <span class="st">'BIC'</span>,
     <span class="dt">xlab =</span> <span class="st">'Number of components'</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">which.min</span>(result<span class="op">$</span>BIC), <span class="dt">lty=</span> <span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="find-start-values" class="section level1">
<h1>Find start values</h1>
<p>In order to find start values for the mean and the variance we use the function <code>createCluster</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span><span class="dv">2</span>
start.musigma2 &lt;-<span class="st"> </span><span class="kw">createCluster</span>(<span class="kw">as.matrix</span>(zd.data), k, 
                                <span class="dt">method =</span> <span class="st">'quantile'</span>)
start.musigma2
<span class="co">#&gt;         mu    sigma2</span>
<span class="co">#&gt; 1 18.57325 25.682100</span>
<span class="co">#&gt; 2 25.70064  1.749551</span></code></pre></div>
</div>
<div id="fitting-distribution-and-find-ecoff" class="section level1">
<h1>Fitting distribution and find ECOFF</h1>
<p>After finding the start values we can use the function <code>em.gauss</code> to fit the mixing distribution of normals to the data. As a result we get the mean, variance, mixing proportions and loglikelihood of the fitted distribution. Furthermore the function provides an estimate of the ECOFF value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(zd)

em.result &lt;-<span class="st"> </span><span class="kw">em.gauss</span>(<span class="dt">y =</span> y,
                      <span class="dt">mu =</span> start.musigma2<span class="op">$</span>mu,
                      <span class="dt">sigma2 =</span> start.musigma2<span class="op">$</span>sigma2,
                      <span class="dt">pi =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span>k, k),
                      <span class="dt">alpha =</span> <span class="dv">3</span>,
                      <span class="dt">beta =</span> <span class="dv">1</span>,
                      <span class="dt">epsilon =</span> <span class="fl">0.0001</span>,
                      <span class="dt">max.iter =</span> <span class="dv">650</span>)</code></pre></div>
</div>
<div id="plot-result" class="section level1">
<h1>Plot result</h1>
<p>Now we use the function plot.fct to plot the fitted distribution and the ECOFF.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_fct</span>(y, 
          <span class="dt">mu =</span> em.result<span class="op">$</span>mu, 
          <span class="dt">sigma2 =</span> em.result<span class="op">$</span>sigma2, 
          <span class="dt">pi =</span> em.result<span class="op">$</span>pi, 
          <span class="dt">ecoff =</span> em.result<span class="op">$</span>ecoff)
<span class="co">#&gt; Warning in hist.default(y, breaks = 30, freq = F, plot = F): argument</span>
<span class="co">#&gt; 'freq' is not made use of</span></code></pre></div>
<p><img src="data:image/png;base64,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ERAQAQEREBABAREQEAEBERAQAQERENDhAT38Ua+t5aHdrfQ69zJqktkTQQsls/ta0MSsRFwiL20dHNB2pRcf1fYyuS9bT9fy3UxlPGii7lLqE0ELpVwvwoRNHr4o34166ejQgOSnpQCZxUjfzjJmPx7JIGiid15R+9OEnWgrBShiYleJo166OjCgXCx1xioMIbvZTdxEAYpaZBffS0ARk6xEgrLS0uHbIANIx3d4qX9z9iFuksk6EbOQ51QbFDHZfGnaOpSVlo4EyNT5SPuxjJrkumgRC1VvFKCwifrZGUkpno5HSQDKbRsdNlG/rxyxsHuIotLLzKQJKBrX5h4JCH3VSgUt9BlQxYzhYp1mFYu1jOUNbdB4qqIFLbLyyZaISenlC9AZdHQkQJG+1d5sC5qYEuWRgYDRJtrN7+qlrSMBCo/OHhb2HmTQpCp5fIi3iQ8UNZIN9NLWsQDV04WWytqhzoVM9A8tr2NOjJWeaoRNdvPSFierQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBJQooIfFdyshlg8L9cSK8+LYShaQfv7+7IN6Vs55ceycJAtoWf1ZOy+OnZNkAa3rP86LY+eEgIAICIiAgAgIiICAEgWUjggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOh3pmNsdJIR+qAAAAAASUVORK5CYII=" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
